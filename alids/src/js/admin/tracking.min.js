(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}jQuery((function(t){({isUrl:function(e){return/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(e)},init:function(){var e=this;Handlebars.registerHelper("gravatar",(function(t,r){return t=Handlebars.escapeExpression(t),e.isUrl(t)?new Handlebars.SafeString('<img src="'+t+'" class="gravatar">'):new Handlebars.SafeString('<span class="gravatar text-uppercase '+r+'">'+t+"</span>")})),Handlebars.registerHelper("image",(function(e,t){return 1===t?e.replace("_640x640.jpg","_50x50.jpg"):e.replace("_640x640.jpg","")}))}}).init();var r={list:"#ali-list-template",orders:"#ali-orders-list",notfound:"#ali-list-notfound",more:"#ali-more-template"},n={page:"#ads_page"},a={request:function(r,n,a){n=""!==n&&"object"===e(n)?window.ADS.serialize(n):n,t.ajax({url:ajaxurl,data:{action:"ads_action_orders",ads_action:r,args:n},type:"POST",dataType:"json",success:a})},listOrders:function(){this.request("list_tracking",t("#params"),this.listOrdersRender)},listOrdersRender:function(e){var n=t(r.list).html(),a=t(r.orders);e&&(e.hasOwnProperty("error")?window.ADS.notify(e.error,"danger"):(0===e.orders.length&&(n=t(r.notfound).html()),a.html(window.ADS.objTotmpl(n,e)),setTimeout(window.ADS.switchery(a),300),a.find(".pagination-menu").length&&window.ADS.createJQPagination("#"+a.attr("id"),e.total,e.ads_page)))},renderChangeStatus:function(e){if(e)if(e.hasOwnProperty("error"))window.ADS.notify(e.error,"danger");else{window.ADS.notify(e.message,"success");var r=t('[data-id="'+e.id+'"]');r.find(".gravatar").addClass(e.color),r.find(".fulfillment").addClass("status-"+e.color)}},handler:function(){var e=this,r=t(document);r.on("click","#btn-clear",(function(){t("#all-fulfillment").val("all").change(),t("#all-tracking_status").val("all").change(),t("#all-filter_tracking").val("all").change(),t.each({ads_page:1,fulfillment:"all",s:"",from:"",to:"",tracking_status:"all"},(function(e,r){t("#params").find('input[name="'+e+'"]').val(r)})),t.event.trigger({type:"datepicker:change"}),e.listOrders(),t.event.trigger({type:"changedocinfo"})})),r.on("pagination:click",(function(r){t(n.page).val(r.page),e.listOrders(),t.event.trigger({type:"changedocinfo"})})),r.on("datepicker:update",(function(){t(n.page).val(1),e.listOrders(),t.event.trigger({type:"changedocinfo"})})),r.on("click","#btn-search",(function(r){r.preventDefault();var a=t("#search").val().trim();t(n.page).val(1),t("#s").val(a),e.listOrders(),t.event.trigger({type:"changedocinfo"})})),r.on("change","#all-fulfillment",(function(r){t("#fulfillment").val(t(this).val()),t("#ads_page").val(1),e.listOrders(),t.event.trigger({type:"changedocinfo"})})),r.on("change","#all-tracking_status",(function(r){t("#tracking_status").val(t(this).val()),t("#ads_page").val(1),e.listOrders(),t.event.trigger({type:"changedocinfo"})})),r.on("change","#all-filter_tracking",(function(r){t("#filter_tracking").val(t(this).val()),t("#ads_page").val(1),e.listOrders(),t.event.trigger({type:"changedocinfo"})})),r.on("change","#all-filter_order",(function(r){t("#filter_order").val(t(this).val()),t("#ads_page").val(1),e.listOrders(),t.event.trigger({type:"changedocinfo"})})),r.on("click",".js-get-tracking",(function(){t(this).find(".fa").addClass("spin");var e=t(this).data("order_number"),r=t(this).data("order_id");e&&r&&window.ADS.aliExtension.getTIPOrder(r,e)})),r.on("click","#all-sync",(function(){t(this).find(".fa").addClass("spin"),a.request("list_ordersIdAli",t("#params"),a.getTIPOrders)})),window.ADS.Dispatcher.on("adsGoogleExtension:setOrderTIP",(function(e){if(void 0!==e.orderIdStore&&void 0!==e.orderDetail.trackingNo)a.listOrders();else{var r=t("#msg-tip-error").text();window.ADS.notify(r)}}),this),window.ADS.Dispatcher.on("adsGoogleExtension:setOrdersTIP",(function(e){if(console.log(e),t("#all-sync .fa").removeClass("spin"),void 0!==e.ordersDetail&&e.ordersDetail.length)a.listOrders();else{var r=t("#msg-tip-error").text();window.ADS.notify(r)}}),this),window.ADS.switchery(t("#action-box"))},getTIPOrders:function(e){e.ordersIdAli&&(t.each(e.ordersIdAli,(function(e,r){t('.js-get-tracking[data-order_number="'+r+'"]').find(".fa").addClass("spin")})),window.ADS.aliExtension.getTIPOrders(e.ordersIdAli))},init:function(){this.handler(),this.listOrders()}};a.init()}))})();